https://github.com/aluminum-ice/pwnagotchi/releases
wget "https://github.com/bettercap/bettercap/archive/refs/tags/v2.32.0.zip"
unzip v2.32.0.zip
# ... check the sha256 digest before doing this ...
sudo mv bettercap /usr/bin/
# install the caplets and the web ui in /usr/local/share/bettercap and quit
sudo bettercap -eval "caplets.update; ui.update; quit"

Depending on the name of the WiFi interface you’re going to use, you’ll need to edit the 
/usr/local/share/bettercap/caplets/pwnagotchi-auto.cap 
/usr/local/share/bettercap/caplets/pwnagotchi-manual.cap caplet files accordingly.

How to run bettercap and in which mode it’s up to you as long as it’s running one of those two caplets. In the default Pwnagotchi image bettercap is running as a systemd service through a launcher script.

This is /etc/systemd/system/bettercap.service:

[Unit]
Description=bettercap api.rest service.
Documentation=https://bettercap.org
Wants=network.target
After=pwngrid.service

[Service]
Type=simple
PermissionsStartOnly=true
ExecStart=/usr/bin/bettercap-launcher
Restart=always
RestartSec=30

[Install]
WantedBy=multi-user.target

And this is /usr/bin/bettercap-launcher:

#!/usr/bin/env bash
/usr/bin/monstart
if [[ $(ifconfig | grep usb0 | grep RUNNING) ]] || [[ $(cat /sys/class/net/eth0/carrier) ]]; then
  # if override file exists, go into auto mode
  if [ -f /root/.pwnagotchi-auto ]; then
    /usr/bin/bettercap -no-colors -caplet pwnagotchi-auto -iface mon0
  else
    /usr/bin/bettercap -no-colors -caplet pwnagotchi-manual -iface mon0
  fi
else
  /usr/bin/bettercap -no-colors -caplet pwnagotchi-auto -iface mon0
fi

wget "https://github.com/evilsocket/pwngrid/releases/download/v1.10.3/pwngrid_linux_amd64_v1.10.3.zip"
unzip pwngrid_linux_amd64_v1.10.3.zip
# ... check the sha256 digest before doing this ...
sudo mv pwngrid /usr/bin/
# generate the keypair
sudo pwngrid -generate -keys /etc/pwnagotchi

Pwngrid runs via the /etc/systemd/system/pwngrid-peer.service systemd service:

[Unit]
Description=pwngrid peer service.
Documentation=https://pwnagotchi.ai
Wants=network.target

[Service]
Type=simple
PermissionsStartOnly=true
ExecStart=/usr/bin/pwngrid -keys /etc/pwnagotchi -address 127.0.0.1:8666 -client-token /root/.api-enrollment.json -wait -log /var/log/pwngrid-peer.log -iface mon0
Restart=always
RestartSec=30

[Install]
WantedBy=multi-user.target

3. pwnagotchi

The last ingredient of this soup is going to be the python3 Pwnagotchi main codebase, that for any release can be installed with:

git clone https://github.com/aluminum-ice/pwnagotchi.git
cd pwnagotchi
# this will install the requirements and pwnagotchi itself
sudo pip3 install -r requirements.txt
sudo pip3 install .

Assuming both bettercap and pwngrid are configured and running correctly, you can now start pwnagotchi by simply:

# AUTO mode
sudo pwnagotchi
# AUTO mode with debug logs
sudo pwnagotchi --debug
# MANU mode
sudo pwnagotchi --manual
# MANU mode with debug logs
sudo pwnagotchi --manual --debug
# show the other options
pwnagotchi -h
